!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("@seniorsistemas/senior-platform-data",[],t):"object"==typeof exports?exports["@seniorsistemas/senior-platform-data"]=t():e["@seniorsistemas/senior-platform-data"]=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(){return c.hasTabData()?c.getToken():f.getServicesUrl().then(function(e){return e?f.getToken():i.getToken()})}function a(){return c.hasTabData()?c.getRestUrl():f.getServicesUrl().then(function(e){return e?e+"rest/":i.getRestUrl()})}Object.defineProperty(t,"__esModule",{value:!0}),t.utils=t.service=t.user=void 0;var u=r(2),i=n(u),s=r(3),c=n(s),l=r(4),f=n(l),d=r(6);t.user={getToken:o,getAuthHeader:function(){return(0,d.getAuthHeader)(o)},getUserData:function(e){return(0,d.getUserData)(a,o,e)},getRememberMe:f.getRememberMe},t.service={getRestUrl:a,getSoapUrl:f.getSoapUrl,getODataUrl:f.getODataUrl},t.utils={getDomain:f.getDomain,getSelectedSub:f.getSelectedSub,getSelectedCompany:f.getSelectedCompany}},function(e,t,r){"use strict";function n(){return u||(console.warn("Senior Platform data not found. Waiting for message event..."),u=new Promise(function(e,t){setTimeout(function(){t(new Error("It was not possible to retrieve the Senior Platform data. Try to get a token on initialization."))},5e3),window.addEventListener("message",function(t){t.data&&t.data.token&&t.data.token.username&&t.data.token.token_type&&e(t.data)})})),u}function o(){return n().then(function(e){return e.servicesUrl})}function a(){return n().then(function(e){return e.token})}Object.defineProperty(t,"__esModule",{value:!0}),t.getRestUrl=o,t.getToken=a;var u=void 0},function(e,t,r){"use strict";function n(){return window&&window.name&&0===window.name.indexOf(u)}function o(){return Promise.resolve(i.servicesUrl)}function a(){return Promise.resolve(i.token)}Object.defineProperty(t,"__esModule",{value:!0}),t.hasTabData=n,t.getRestUrl=o,t.getToken=a;var u=t.PREFIX="SENIOR_CREDENTIALS",i=n()?JSON.parse(window.name.substring(u.length)):{}},function(e,t,r){"use strict";function n(){return Promise.resolve(m.default.get("com.senior.services.url"))}function o(){return n().then(function(e){return e?e+"rest/":m.default.get("com.senior.pau.services.url")})}function a(){return n().then(function(e){return e?e+"soap/":m.default.get("com.senior.pau.soap.url")})}function u(){return n().then(function(e){return e?e+"odata/":m.default.get("com.senior.pau.odata.url")})}function i(){var e=JSON.parse(m.default.get("com.senior.token")||"{}");return Object.keys(e).length||(e=JSON.parse(JSON.parse(m.default.get("com.senior.pau.token")||'"{}"'))),Promise.resolve(e)}function s(){return Promise.resolve(m.default.get("com.senior.rememberme")||m.default.get("com.senior.pau.rememberme"))}function c(){return Promise.resolve(m.default.get("com.senior.domain")||m.default.get("com.senior.pau.domain"))}function l(){return Promise.resolve(m.default.get("com.senior.selectedSub")||m.default.get("com.senior.pau.selectedSub"))}function f(){return Promise.resolve(m.default.get("com.senior.selectedCompany")||m.default.get("com.senior.pau.selectedCompany"))}Object.defineProperty(t,"__esModule",{value:!0}),t.getServicesUrl=n,t.getRestUrl=o,t.getSoapUrl=a,t.getODataUrl=u,t.getToken=i,t.getRememberMe=s,t.getDomain=c,t.getSelectedSub=l,t.getSelectedCompany=f;var d=r(5),m=function(e){return e&&e.__esModule?e:{default:e}}(d)},function(e,t){e.exports=require("js-cookie")},function(e,t,r){"use strict";function n(e){return e().then(function(e){return e&&Object.keys(e).length?e.token_type+" "+e.access_token:""})}function o(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=localStorage.getItem(c)||l;return Promise.all([e(),t()]).then(function(e){var t=a(e,2),o=t[0],u=t[1],c=null,l=localStorage.getItem(s);if(r&&l){var f=JSON.parse(l);if(f.data.username+"@"+f.data.tenantDomain===u.username&&f.ttl>Date.now())return new Promise(function(e){return e(f.data)});f.ttl<Date.now()&&(c=f.ETag)}return i.default.post(o+"platform/user/queries/getUser",{includePhoto:!0},{headers:{Authorization:u.token_type+" "+u.access_token,Accept:"application/json;seniorx.version=8","If-None-Match":c}}).then(function(e){var t=Date.now()+Number(n),r={data:e.data,ttl:t,ETag:e.headers.ETag};return 304===e.status&&(r.data=JSON.parse(l).data),localStorage.setItem(s,JSON.stringify(r)),r.data})})}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var u,i=e[Symbol.iterator]();!(n=(u=i.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&i.return&&i.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.getAuthHeader=n,t.getUserData=o;var u=r(7),i=function(e){return e&&e.__esModule?e:{default:e}}(u),s="SENIOR_USER_INFO",c="SENIOR_USER_INFO_TTL",l="1800000"},function(e,t){e.exports=require("axios")}])});